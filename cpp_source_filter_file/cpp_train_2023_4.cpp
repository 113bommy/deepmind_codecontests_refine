#include <bits/stdc++.h>
using namespace std;
int d[1000000][6];
int main() {
  int n, i, type;
  string s;
  cin >> s;
  n = s.length();
  d[0][0] = ((s[0] == '0') || (s[0] == '?'));
  d[0][2] = ((s[0] == '1') || (s[0] == '?'));
  d[0][4] = ((s[0] == '*') || (s[0] == '?'));
  for (i = 1; i < n; ++i) {
    if ((s[i] == '0') || (s[i] == '?')) {
      d[i][0] =
          ((d[i - 1][0] + d[i - 1][1]) % 1000000007 + 1000000007) % 1000000007;
    }
    if (((s[i] == '1') || (s[i] == '?')) &&
        ((s[i - 1] == '*') || (s[i - 1] == '?')))
      d[i][1] = d[i - 1][4];
    if ((i < n - 1) && (((s[i] == '1') || (s[i] == '?')) &&
                        ((s[i + 1] == '*') || (s[i + 1] == '?'))))
      d[i][2] = (((d[i - 1][0] + d[i - 1][1]) % 1000000007) + 1000000007) %
                1000000007;
    if (((s[i] == '2') || (s[i] == '?')) &&
        ((s[i - 1] == '*') || (s[i - 1] == '?')) &&
        ((s[i + 1] == '?') || (s[i + 1] == '*'))) {
      d[i][3] = d[i - 1][4];
    }
    if ((s[i] == '*') || (s[i] == '?'))
      d[i][4] = ((((d[i - 1][2] + d[i - 1][3]) % 1000000007 + d[i - 1][4]) %
                  1000000007) +
                 1000000007) %
                1000000007;
  }
  cout << (((d[n - 1][0] + d[n - 1][1] + d[n - 1][4]) % 1000000007 +
            1000000007) %
           1000000007);
  return 0;
}
