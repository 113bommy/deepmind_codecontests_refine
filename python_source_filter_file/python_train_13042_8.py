for _ in range(int(input())):
	n,m=map(int,input().split())
	l=[]
	for i in range(n):
		s=str(input())
		t=[]
		for i in range(len(s)):
			t.append(int(s[i]))
		l.append(t)

	lr,lc=[],[]
	for i in range(n-2):
		for j in range(m):
			if(j==m-1):
				if(l[i][j]==1):
					lr.append(i)
					lc.append(j)
					l[i][j]=0
					lr.append(i+1)
					lc.append(j-1)
					l[i+1][j-1]=1-l[i+1][j-1]
					lr.append(i+1)
					lc.append(j)
					l[i+1][j]=1-l[i+1][j]
			else:
				if(l[i][j]==1):
					lr.append(i)
					lc.append(j)
					l[i][j]=0
					lr.append(i+1)
					lc.append(j+1)
					l[i+1][j+1]=1-l[i+1][j+1]
					lr.append(i+1)
					lc.append(j)
					l[i+1][j]=1-l[i+1][j]

	if(m%2!=0):
		if(l[n-2][m-1]==1):
			lr.append(n-2)
			lc.append(m-1)
			l[n-2][m-1]=0
			lr.append(n-2)
			lc.append(m-2)
			l[n-2][m-2]=1-l[n-2][m-2]
			lr.append(n-1)
			lc.append(m-2)
			l[n-1][m-2]=1-l[n-1][m-2]
		if(l[n-1][m-1]==1):
			lr.append(n-1)
			lc.append(m-1)
			l[n-1][m-1]=0
			lr.append(n-2)
			lc.append(m-2)
			l[n-2][m-2]=1-l[n-2][m-2]
			lr.append(n-1)
			lc.append(m-2)
			l[n-1][m-2]=1-l[n-1][m-2]

	i=n-2
	for j in range(0,m-1,2):
		if(l[i][j]==1 and l[i+1][j]==1 and l[i][j+1]==1 and l[i+1][j+1]==1):
			lr.append(i)
			lc.append(j)
			lr.append(i+1)
			lc.append(j)
			lr.append(i)
			lc.append(j+1)
			lr.append(i)
			lc.append(j)
			lr.append(i+1)
			lc.append(j)
			lr.append(i+1)
			lc.append(j+1)
			lr.append(i)
			lc.append(j)
			lr.append(i)
			lc.append(j+1)
			lr.append(i+1)
			lc.append(j+1)
			lr.append(i)
			lc.append(j+1)
			lr.append(i+1)
			lc.append(j)
			lr.append(i+1)
			lc.append(j+1)
		elif(l[i][j]==1 and l[i+1][j]==1 and l[i+1][j+1]==1):
			lr.append(i)
			lc.append(j)
			lr.append(i+1)
			lc.append(j)
			lr.append(i+1)
			lc.append(j+1)
		elif(l[i][j]==1 and l[i][j+1]==1 and l[i+1][j]==1):
			lr.append(i)
			lc.append(j)
			lr.append(i)
			lc.append(j+1)
			lr.append(i+1)
			lc.append(j)
		elif(l[i][j]==1 and l[i][j+1]==1 and l[i+1][j+1]==1):
			lr.append(i)
			lc.append(j)
			lr.append(i)
			lc.append(j+1)
			lr.append(i+1)
			lc.append(j+1)
		elif(l[i][j+1]==1 and l[i+1][j]==1 and l[i+1][j+1]==1):
			lr.append(i)
			lc.append(j+1)
			lr.append(i+1)
			lc.append(j)
			lr.append(i+1)
			lc.append(j+1)
		elif(l[i][j]==1 and l[i+1][j]==1):
			lr.append(i)
			lc.append(j+1)
			lr.append(i+1)
			lc.append(j+1)
			lr.append(i+1)
			lc.append(j)
			lr.append(i)
			lc.append(j)
			lr.append(i)
			lc.append(j+1)
			lr.append(i+1)
			lc.append(j+1)
		elif(l[i][j]==1 and l[i][j+1]==1):
			lr.append(i)
			lc.append(j+1)
			lr.append(i+1)
			lc.append(j)
			lr.append(i+1)
			lc.append(j+1)
			lr.append(i)
			lc.append(j)
			lr.append(i+1)
			lc.append(j+1)
			lr.append(i+1)
			lc.append(j)
		elif(l[i][j+1]==1 and l[i+1][j+1]==1):
			lr.append(i)
			lc.append(j)
			lr.append(i)
			lc.append(j+1)
			lr.append(i+1)
			lc.append(j+1)
			lr.append(i+1)
			lc.append(j)
			lr.append(i)
			lc.append(j+1)
			lr.append(i+1)
			lc.append(j+1)
		elif(l[i+1][j]==1 and l[i+1][j+1]==1):
			lr.append(i)
			lc.append(j)
			lr.append(i+1)
			lc.append(j)
			lr.append(i)
			lc.append(j+1)
			lr.append(i)
			lc.append(j)
			lr.append(i)
			lc.append(j+1)
			lr.append(i+1)
			lc.append(j+1)
		elif(l[i][j]==1 and l[i+1][j+1]==1):
			lr.append(i)
			lc.append(j)
			lr.append(i+1)
			lc.append(j)
			lr.append(i)
			lc.append(j+1)
			lr.append(i+1)
			lc.append(j+1)
			lr.append(i+1)
			lc.append(j)
			lr.append(i)
			lc.append(j+1)
		elif(l[i][j+1]==1 and l[i+1][j]==1):
			lr.append(i)
			lc.append(j)
			lr.append(i)
			lc.append(j+1)
			lr.append(i+1)
			lc.append(j+1)
			lr.append(i)
			lc.append(j)
			lr.append(i+1)
			lc.append(j)
			lr.append(i+1)
			lc.append(j+1)
		elif(l[i][j]==1):
			lr.append(i)
			lc.append(j)
			lr.append(i)
			lc.append(j+1)
			lr.append(i+1)
			lc.append(j+1)
			lr.append(i)
			lc.append(j)
			lr.append(i+1)
			lc.append(j)
			lr.append(i+1)
			lc.append(j+1)
			lr.append(i)
			lc.append(j)
			lr.append(i+1)
			lc.append(j)
			lr.append(i)
			lc.append(j+1)
		elif(l[i][j+1]==1):
			lr.append(i)
			lc.append(j+1)
			lr.append(i+1)
			lc.append(j)
			lr.append(i+1)
			lc.append(j+1)
			lr.append(i)
			lc.append(j)
			lr.append(i+1)
			lc.append(j)
			lr.append(i)
			lc.append(j+1)
			lr.append(i)
			lc.append(j)
			lr.append(i)
			lc.append(j+1)
			lr.append(i+1)
			lc.append(j+1)
		elif(l[i+1][j]==1):
			lr.append(i)
			lc.append(j)
			lr.append(i)
			lc.append(j+1)
			lr.append(i+1)
			lc.append(j)
			lr.append(i)
			lc.append(j)
			lr.append(i+1)
			lc.append(j)
			lr.append(i+1)
			lc.append(j+1)
			lr.append(i)
			lc.append(j+1)
			lr.append(i+1)
			lc.append(j)
			lr.append(i+1)
			lc.append(j+1)
		elif(l[i+1][j+1]==1):
			lr.append(i)
			lc.append(j)
			lr.append(i+1)
			lc.append(j)
			lr.append(i+1)
			lc.append(j+1)
			lr.append(i)
			lc.append(j)
			lr.append(i)
			lc.append(j+1)
			lr.append(i+1)
			lc.append(j+1)
			lr.append(i+1)
			lc.append(j)
			lr.append(i)
			lc.append(j+1)
			lr.append(i+1)
			lc.append(j+1)

	
	print(len(lr)//3)
	for i in range(0,len(lr),3):
		print(lr[i]+1,lc[i]+1,lr[i+1]+1,lc[i+1]+1,lr[i+2]+1,lc[i+2]+1)
	